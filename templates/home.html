{% extends 'base.html' %} {% block title %}Dashboard Summary{% endblock %} {%
block content %}

<!-- METRIC CARDS SECTION -->
<section class="py-40">
	<!-- Metrics Grid -->
	<div class="metrics-grid">
		<!-- METRIC 1: Active Flood Alerts -->
		<div class="metric-card metric-card-{{ metrics.highest_alert_level }}">
			<div class="metric-header">Active Flood Alerts</div>
			<div class="metric-value">
				<span>{{ metrics.highest_alert_count }}</span>
				<span class="metric-icon">
					{% if metrics.highest_alert_level == 'critical' or
					metrics.highest_alert_level == 'warning' or
					metrics.highest_alert_level == 'alert' or metrics.highest_alert_level
					== 'advisory' %}
					<i class="fas fa-bell" style="color: #dc2626"></i>
					{% else %}
					<i class="fas fa-check-circle" style="color: #409ac7"></i>
					{% endif %}
				</span>
			</div>
		</div>

		<!-- METRIC 2: Rainfall Forecast -->
		<div class="metric-card">
			<div class="metric-header">Rainfall Forecast</div>
			<div class="metric-value">
				<span>{{ metrics.rainfall_forecast.level }}</span>
				<span class="metric-icon">
					<i
						class="fas {{ metrics.rainfall_forecast.icon }}"
						style="color: {{ metrics.rainfall_forecast.color }};"
					></i>
				</span>
			</div>
		</div>

		<!-- METRIC 3: Stations Requiring Attention -->
		<div class="metric-card">
			<div class="metric-header">Stations Requiring Attention</div>
			<div class="metric-value">
				<span
					>{{ metrics.attention_stations|length }}/{{ metrics.total_sensors
					}}</span
				>
				<span class="metric-icon">
					{% if metrics.attention_stations|length > 0 %}
					<i class="fas fa-exclamation-triangle" style="color: #dc2626"></i>
					{% else %}
					<i class="fas fa-check-circle" style="color: #409ac7"></i>
					{% endif %}
				</span>
			</div>
		</div>

		<!-- METRIC 4: Weather Stations Online -->
		<div class="metric-card">
			<div class="metric-header">Weather Stations Online</div>
			<div class="metric-value">
				<span>{{ metrics.online_sensors }}/{{ metrics.total_sensors }}</span>
				<span class="metric-icon">
					{% if metrics.online_sensors == metrics.total_sensors %}
					<i class="fas fa-check-circle" style="color: #409ac7"></i>
					{% else %}
					<i class="fas fa-exclamation-circle" style="color: #94a3b8"></i>
					{% endif %}
				</span>
			</div>
		</div>
	</div>

	<!-- Flood Alert Badges (Below Cards) -->
	{% if metrics.critical_count > 0 or metrics.warning_count > 0 or
	metrics.alert_count > 0 %}
	<div class="alert-badges">
		{% if metrics.critical_count > 0 %}
		<span class="badge badge-critical">
			<i class="fas fa-exclamation-triangle"></i>
			FLOOD - Critical ({{ metrics.critical_count }})
		</span>
		{% endif %} {% if metrics.warning_count > 0 %}
		<span class="badge badge-warning">
			<i class="fas fa-exclamation-circle"></i>
			FLOOD - WARNING ({{ metrics.warning_count }})
		</span>
		{% endif %} {% if metrics.alert_count > 0 %}
		<span class="badge badge-alert">
			<i class="fas fa-bell"></i>
			FLOOD - ALERT ({{ metrics.alert_count }})
		</span>
		{% endif %}
	</div>
	{% endif %}
</section>

{% endblock %} {% block extra_js %}
<script>
	// Add click handlers for metric cards
	document.querySelectorAll(".metric-card").forEach((card) => {
		card.addEventListener("click", function () {
			const isCritical = this.classList.contains("metric-card-critical");
			const isWarning = this.classList.contains("metric-card-warning");
			const isAttention = this.classList.contains("metric-card-attention");

			if (isCritical) {
				console.log("Navigate to critical alerts");
				// TODO: Scroll to alerts section or open modal
			} else if (isWarning) {
				console.log("Navigate to warnings");
			} else if (isAttention) {
				console.log("Show stations needing attention");
			}
		});

		// Keyboard accessibility
		card.addEventListener("keypress", function (e) {
			if (e.key === "Enter" || e.key === " ") {
				e.preventDefault();
				this.click();
			}
		});
	});
</script>
{% endblock %}
